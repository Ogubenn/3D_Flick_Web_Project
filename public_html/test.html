<!DOCTYPE html>
<html lang="tr" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal Test</title>
    <link rel="stylesheet" href="./new-style.css">
</head>
<body>
    <div class="container">
        <h1>Modal Sistemi Test</h1>
        
        <button data-modal="testModal">Test Modal Aç</button>
        <button id="uploadBtn">Upload Modal Aç</button>
        <button id="galleryBtn">Gallery Modal Aç</button>
    </div>
    
    <!-- Test Modal -->
    <div class="modal-overlay" id="testModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Test Modal</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <p>Bu bir test modalıdır.</p>
            </div>
        </div>
    </div>
    
    <!-- Upload Modal -->
    <div class="modal-overlay" id="uploadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">📤 STL Dosyası Yükle</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <p>STL dosyası yükleme modalı</p>
            </div>
        </div>
    </div>
    
    <!-- Gallery Modal -->
    <div class="modal-overlay" id="galleryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">🖼️ Figür Galerim</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <p>Figür galerisi modalı</p>
            </div>
        </div>
    </div>

    <script>
        // Yeni Modal Sistemi - Test
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Test modal sistemi yükleniyor...');
            
            // Modal açma fonksiyonu
            function openModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal && modal.classList.contains('modal-overlay')) {
                    // Önce tüm modalleri kapat
                    closeAllModals();
                    
                    // Seçilen modalı aç
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden';
                    
                    console.log('Modal açıldı:', modalId);
                } else {
                    console.log('Modal bulunamadı:', modalId);
                }
            }
            
            // Modal kapatma fonksiyonu
            function closeModal(modalId) {
                const modal = modalId ? document.getElementById(modalId) : document.querySelector('.modal-overlay.show');
                if (modal) {
                    modal.classList.remove('show');
                    document.body.style.overflow = '';
                    console.log('Modal kapatıldı:', modal.id);
                }
            }
            
            // Tüm modalleri kapat
            function closeAllModals() {
                document.querySelectorAll('.modal-overlay.show').forEach(modal => {
                    modal.classList.remove('show');
                });
                document.body.style.overflow = '';
            }
            
            // Event delegation ile modal açma butonlarını dinle
            document.addEventListener('click', function(e) {
                const target = e.target.closest('[data-modal]');
                if (target) {
                    e.preventDefault();
                    const modalId = target.getAttribute('data-modal');
                    console.log('Modal açma isteği:', modalId);
                    openModal(modalId);
                    return;
                }
                
                // Modal kapatma butonları (.modal-close)
                if (e.target.closest('.modal-close')) {
                    e.preventDefault();
                    const modal = e.target.closest('.modal-overlay');
                    if (modal) {
                        console.log('Modal kapatma isteği:', modal.id);
                        closeModal(modal.id);
                    }
                    return;
                }
                
                // Overlay'e (modal dışına) tıklama ile kapatma
                if (e.target.classList.contains('modal-overlay')) {
                    console.log('Overlay tıklama, modal kapatılıyor:', e.target.id);
                    closeModal(e.target.id);
                    return;
                }
            });
            
            // ESC tuşu ile modal kapatma
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const activeModal = document.querySelector('.modal-overlay.show');
                    if (activeModal) {
                        console.log('ESC ile modal kapatılıyor:', activeModal.id);
                        closeModal(activeModal.id);
                    }
                }
            });
            
            // Özel butonlar için event listenerlar
            document.getElementById('uploadBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                console.log('Upload butonu tıklandı');
                openModal('uploadModal');
            });
            
            document.getElementById('galleryBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                console.log('Gallery butonu tıklandı');
                openModal('galleryModal');
            });
            
            console.log('Test modal sistemi hazır. Modaller:', document.querySelectorAll('.modal-overlay').length);
        });
    </script>
</body>
</html>